"use strict";(self.webpackChunksf_documentation=self.webpackChunksf_documentation||[]).push([[8634],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,k=d["".concat(l,".").concat(m)]||d[m]||u[m]||i;return n?a.createElement(k,o(o({ref:t},c),{},{components:n})):a.createElement(k,o({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5316:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],s={},l="Custom Monitoring using StatsD",p={unversionedId:"Integrations/statsd/custom_monitoring",id:"Integrations/statsd/custom_monitoring",isDocsHomePage:!1,title:"Custom Monitoring using StatsD",description:"Overview",source:"@site/docs/Integrations/statsd/custom_monitoring.md",sourceDirName:"Integrations/statsd",slug:"/Integrations/statsd/custom_monitoring",permalink:"/docs/Integrations/statsd/custom_monitoring",editUrl:"https://github.com/ram-dot-kumar/SFwebsite.git/docs/Integrations/statsd/custom_monitoring.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Monitoring Windows Instances",permalink:"/docs/Integrations/os/windows/sfagent_windows"},next:{title:"Monitoring ActiveMQ Message Broker running on Instances",permalink:"/docs/Integrations/activemq"}},c=[{value:"Overview",id:"overview",children:[]},{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Configuration",id:"configuration",children:[]},{value:"Operating Instructions",id:"operating-instructions",children:[]},{value:"Creating Rules File",id:"creating-rules-file",children:[{value:"Rule to create nested json: &quot;NESTED&quot;",id:"rule-to-create-nested-json-nested",children:[]},{value:"Rule to create flat json: &quot;FLAT&quot;",id:"rule-to-create-flat-json-flat",children:[]},{value:"&quot;RENDER&quot; Rule:",id:"render-rule",children:[]}]},{value:"Tagging",id:"tagging",children:[]},{value:"Sidekiq Use-case",id:"sidekiq-use-case",children:[{value:"Description",id:"description",children:[]},{value:"Installation",id:"installation",children:[]},{value:"Sample Metrics",id:"sample-metrics",children:[]},{value:"Rules",id:"rules",children:[]},{value:"sfAgent Configuration",id:"sfagent-configuration",children:[]}]},{value:"See Also",id:"see-also",children:[]}],u={toc:c};function d(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"custom-monitoring-using-statsd"},"Custom Monitoring using StatsD"),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"StatsD is a popular standard for developing infrastructure and application plugins. A wide suite of standard plugins are available from Statsd community and can be accessed ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/statsd/statsd/wiki#client-implementations"},"here")),(0,i.kt)("p",null,"sfAgent Statsd plugin integrates to Statsd client in the following way: "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Runs a daemon to listen to UDP port for data being sent by statsd client and accumulates all metrics being sent in the last N seconds (called flushinterval) "),(0,i.kt)("li",{parentName:"ul"},"Translates the data from statsd format to SnappyFlow\u2019s format "),(0,i.kt)("li",{parentName:"ul"},"Forwards the data to SnappyFlow with necessary tags ")),(0,i.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create a rules file for a statsd client or contact ",(0,i.kt)("a",{parentName:"li",href:"mailto:support@snappyflow.io"},"support@snappyflow.io")," to create the rules file for a specific statsd client. ")),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"User can also manually add the configuration shown below to ",(0,i.kt)("inlineCode",{parentName:"p"},"config.yaml")," under ",(0,i.kt)("inlineCode",{parentName:"p"},"/opt/sfagent/")," directory "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"key: <profile_key> \ntags: \n  Name: <name> \n  appName: <app_name> \n  projectName: <project_name> \nmetrics: \n  plugins: \n    - name: statsd \n      enabled: true \n      config: \n        port:8125 \n        flushinterval:30 \n        ruleFile: /path/to/rules/file \n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"port"),": The UDP port on which statsd client sends metrics. sfAgent runs a statsd server listening on this port for the UDP datagrams. Default value is 8125. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"flushInterval"),": SnappyFlow\u2019s statsd plugin collects all the metrics received in the last N seconds and sends the data to SnappyFlow as a single document  "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"ruleFile"),": User generated statsd rules file path or please contact ",(0,i.kt)("a",{parentName:"p",href:"mailto:support@snappyflow.io"},"support@snappyflow.io")," to create a rule file for a specific statsd client."),(0,i.kt)("h2",{id:"operating-instructions"},"Operating Instructions"),(0,i.kt)("p",null,"Validate the statsd configuration and the rules. It is mandatory to run this command after any change is made in the statsd rules file, followed by restarting the sfAgent service. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"sudo /opt/sfagent/sfagent -check-config\n")),(0,i.kt)("h2",{id:"creating-rules-file"},"Creating Rules File"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"statsd metrics are expected in the format shown below"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"namespace.prefix.[type.]metric:value|metricType\n")),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Example")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"ClusterA.Kafka1.Topic1.Lag:500|g\n")),(0,i.kt)("p",{parentName:"li"},"In this case,"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"namespace= ClusterA,\nprefix= Kafka1,\ntype= Topic1,\nmetric= Lag,\nvalue= 500,\nmetricType= g(gauge)\n")))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"The field ",(0,i.kt)("inlineCode",{parentName:"p"},"type")," is optional. If this field is present, it will enforce a nested json else the resulting json will be flat "),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Example")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"Kafka1.General.numTopic:5|g\n")),(0,i.kt)("p",{parentName:"li"},"In this case,"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"namespace= Kafka1,\nprefix= General,\nmetric= numTopic,\nvalue= 5,\nmetricType= g (gauge)\n")),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"namespace"),"= ",(0,i.kt)("inlineCode",{parentName:"p"},"Kafka1"),",\n",(0,i.kt)("inlineCode",{parentName:"p"},"prefix"),"= ",(0,i.kt)("inlineCode",{parentName:"p"},"General"),",\n",(0,i.kt)("inlineCode",{parentName:"p"},"metric"),"= ",(0,i.kt)("inlineCode",{parentName:"p"},"numTopic"),",\n",(0,i.kt)("inlineCode",{parentName:"p"},"value"),"= ",(0,i.kt)("inlineCode",{parentName:"p"},"5"),",\n",(0,i.kt)("inlineCode",{parentName:"p"},"metricType"),"= ",(0,i.kt)("inlineCode",{parentName:"p"},"g")," (gauge)"))),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"In special cases where namespace is not present and the metrics start directly with prefix, set ",(0,i.kt)("inlineCode",{parentName:"p"},"namespace"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"none"),". "),(0,i.kt)("p",{parentName:"div"},"Supported datatypes are ",(0,i.kt)("inlineCode",{parentName:"p"},"float"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"double"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"long"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"integer"),". "))),(0,i.kt)("h3",{id:"rule-to-create-nested-json-nested"},'Rule to create nested json: "NESTED"'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"<json_key> = NESTED(namespace: <namespace>, prefix: <prefix_name>, key: <type_key>, metric: [<list of metrics along with datatypes>])\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"<json_key>"),": key of the final nested json. "),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"<namespace>"),": This rule is applied to all metrics having this namespace "),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"<prefix>"),": This rule is applied to all metrics having this prefix. "),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"<key>"),": adds a key:value pair in the nested json "),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"<metric>"),": Specify all the metrics to collect for this prefix."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"DB.host1.disk1.readLatency:20|g \nDB.host1.disk1.writeLatency:50|g \n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Rule")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"latency = NESTED(namespace: DB, prefix: host1, key: diskName, metric:[readLatency:float, writeLatency:float]) \n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Output")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'"latency": [ \n{ \n   "diskName": disk1, \n   "readLatency":20, \n   "writeLatency": 50 \n}, \n{ \n   "diskName": disk2, \n   "readLatency":25, \n   "writeLatency": 45 \n} \n ] \n')),(0,i.kt)("h3",{id:"rule-to-create-flat-json-flat"},'Rule to create flat json: "FLAT"'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"<json_key> = FLAT(namespace: <namespace>, prefix: <prefix_name>, metric: <metric_name>) \n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"<namespace>"),": This rule is applied to all metrics having this namespace "),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"<prefix>"),": This rule is applied to all metrics having this prefix. "),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"<metric>"),": Specify all the metrics to collect for this prefix. "),(0,i.kt)("p",null," ",(0,i.kt)("strong",{parentName:"p"},"Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Kafka1.System.cpuutil:10|g,\nKafka1.System.ramutil:20|g,\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Rule")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"computeMetrics = FLAT(namespace: Kafka1, prefix: System, metric: [cpuutil:float, ramutil:float]) \n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Output")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'"cpuutil": 10, \n\u201cramutil\u201d:20 \n')),(0,i.kt)("h3",{id:"render-rule"},'"RENDER" Rule:'),(0,i.kt)("p",null,"Extraction rules mentioned above, extract a set of metrics from statsd datagrams. These extracted metrics are grouped together in documents and shipped to SnappyFlow. Render rules describe grouping of metrics into documentType "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"RENDER(_documentType: <doctype>, m1, m2,\u2026mn) where m1..mn can be metric names or Rule names \n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example")),(0,i.kt)("p",null,"RENDER(documentType: system, computeMetrics, latency) will create a documentType       "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{ \nplugin: statsd \ndocumentType: system \n"cpuutil": 10, \n\u201cramutil\u201d: 20 \n"latency": [ \n        { \n        "diskName": disk1, \n        "readLatency":20, \n        "writeLatency": 50 \n        }, \n        { \n         \u201cdiskName\u201d: disk2, \n         \u201creadLatency\u201d:25, \n         \u201cwriteLatency\u201d: 45 \n        } \n        ] \n} \n')),(0,i.kt)("h2",{id:"tagging"},"Tagging"),(0,i.kt)("p",null,"sfAgent statsD plugin is capable of parsing and forwarding the tags contained in the statsd metric datagrams. Tags are expressed in different formats based on the intended destination being Datadog, Influx or Graphite.  "),(0,i.kt)("p",null,"Add TAGTYPE rule in the statsd rules file to enable the parsing. Default TAGTYPE is\u202f",(0,i.kt)("strong",{parentName:"p"},"None"),"\u202fi.e. no custom tags present. In each of the formats below, the tags are recognized and passed forward into SnappyFlow documents "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"TAGTYPE = Datadog"),(0,i.kt)("p",{parentName:"li"},"Sample metric:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"Cluster1.kafka1.cpuUtil:35|c|#_tag_appName:testApp1,_tag_projectName:apmProject,_documentType:cpuStats\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"TAGTYPE = Influx"),(0,i.kt)("p",{parentName:"li"},"Sample metric:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"Cluster1.Kafka1.cpuUtil,_tag_appName=testApp1,_tag_projectName=apmProject,_documentType=cpuStats:35|c\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"TAGTYPE = Graphite"),(0,i.kt)("p",{parentName:"li"},"Sample metric:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"Cluster1.Kafka1.cpuUtil;_tag_appName=testApp1;_tag_projectName=apmProject;_documentType=cpuStats:35|c\n")))),(0,i.kt)("h2",{id:"sidekiq-use-case"},"Sidekiq Use-case"),(0,i.kt)("p",null,"This section shows to monitor sidekiq using statsd with sfAgent. "),(0,i.kt)("h3",{id:"description"},"Description"),(0,i.kt)("p",null,"We will use a simple ruby on rails application which shows endangered sharks\u2019 data. "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"There are two sidekiq worker configured, one to add the data and another to remove the sharks data named as\u202f",(0,i.kt)("inlineCode",{parentName:"li"},"AddEndangeredWorker"),"\u202fand\u202f",(0,i.kt)("inlineCode",{parentName:"li"},"RemoveEndangeredWorker"),"\u202frespectively. "),(0,i.kt)("li",{parentName:"ul"},"Sidekiq statsd client is also configured to get the metrics. "),(0,i.kt)("li",{parentName:"ul"},"For this example,\u202f",(0,i.kt)("a",{parentName:"li",href:"https://github.com/phstc/sidekiq-statsd"},"sidekiq-statsd"),"\u202fby phstc is used as the client. ")),(0,i.kt)("h3",{id:"installation"},"Installation"),(0,i.kt)("p",null,"Skip this part if the statsd client is already configured. "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Follow this\u202f",(0,i.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-add-sidekiq-and-redis-to-a-ruby-on-rails-application"},"documentation to setup the ruby on rails application"),", if needed"),(0,i.kt)("li",{parentName:"ol"},"To add the statsd client: ",(0,i.kt)("ol",{parentName:"li"},(0,i.kt)("li",{parentName:"ol"},"Create a new file sidekiq.rb under config/initializers/ and add the\u202f",(0,i.kt)("a",{parentName:"li",href:"https://github.com/phstc/sidekiq-statsd#configuration"},"configuration specified here"),". "),(0,i.kt)("li",{parentName:"ol"},"Install the\u202f","[sidekiq-statsd gem]","(",(0,i.kt)("a",{parentName:"li",href:"https://github.com/phstc/sidekiq-statsd%22"},'https://github.com/phstc/sidekiq-statsd"'),' /l "installation)\u202fand run the application. ')))),(0,i.kt)("h3",{id:"sample-metrics"},"Sample Metrics"),(0,i.kt)("p",null,"Metrics are generated upon worker activation in the application. "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add endangered worker metrics"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"production.worker.AddEndangeredWorker.processing_time:1113|ms\nproduction.worker.AddEndangeredWorker.success:1|c\nproduction.worker.enqueued:0|g\nproduction.worker.retry_set_size:0|g\nproduction.worker.processed:69|g\nproduction.worker.failed:0|g\nproduction.worker.queues.default.enqueued:0|g\nproduction.worker.queues.default.latency:0|g\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Remove endangered worker metrics"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"production.worker.RemoveEndangeredWorker.processing_time:1472|ms\nproduction.worker.RemoveEndangeredWorker.success:1|c\nproduction.worker.enqueued:0|g\nproduction.worker.retry_set_size:0|g\nproduction.worker.processed:107|g\nproduction.worker.failed:0|g\nproduction.worker.queues.default.enqueued:0|g\nproduction.worker.queues.default.latency:0|g\n")))),(0,i.kt)("h3",{id:"rules"},"Rules"),(0,i.kt)("p",null,"Follow the Rules User Guide section to understand the rules. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"TAGTYPE = None\n\nworker = NESTED(namespace: production, prefix: worker, key: worker_name, metric:[processing_time:double, success:float])\n\nqueues = NESTED(namespace: production, prefix: worker.queues, key: queue_name, metric:[enqueued:float, latency:float])\n\nprocessedJobs = FLAT(namespace: production, prefix: worker, metric: processed:integer)\n\nRENDER(_documentType: sidekiq, worker, queues, processedJobs)\n")),(0,i.kt)("h3",{id:"sfagent-configuration"},"sfAgent Configuration"),(0,i.kt)("p",null,"Content of the ",(0,i.kt)("inlineCode",{parentName:"p"},"/opt/sfagent/config.yaml"),". The rules file is ",(0,i.kt)("inlineCode",{parentName:"p"},"/opt/sfagent/statsd-rules.txt")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"key: <profile_key>\ntags:\n  Name: <instance-name>\n  appName: <app-name>\n  projectName: <project-name>\nmetrics:\n  plugins:\n  - name: statsd\n      enabled: true\n      config:\n        port: 8125\n        flushInterval: 10\n        ruleFile: '/opt/sfagent/statsd-rules.txt'\n")),(0,i.kt)("p",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'{\n  "_documentType": "sidekiq",\n  "_tag_Name": "vm",\n  "queues": [\n    {\n      "latency": 0,\n      "queue_name": "default",\n      "enqueued": 0\n    }\n  ],\n  "_plugin": "statsD",\n  "processedJobs": 107,\n  "worker": [\n    {\n      "processing_time": 1472,\n      "worker_name": "RemoveEndangeredWorker",\n      "success": 1\n    },\n    {\n      "processing_time": 1113,\n      "worker_name": "AddEndangeredWorker",\n      "success": 1\n    }\n  ],\n  "_tag_projectName": "statsDProject",\n  "_tag_uuid": "080027957dd8",\n  "time": 1616132931981,\n  "_tag_appName": "statsDApp"\n}\n')),(0,i.kt)("h2",{id:"see-also"},"See Also"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/integrations/os/linux/linux_os"},"Linux monitoring")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/integrations/os/linux/lsof"},"LSOF")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/integrations/os/linux/netstat"},"NETSTAT")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/Integrations/kubernetes/prometheus_exporter"},"Prometheus Integration")))}d.isMDXComponent=!0}}]);